<div class="row" [nbSpinner]="loading">
  <div class="col-lg-12">
    <form [formGroup]="moduleField">
      <nb-card>
        <nb-card-header>
          <label>{{(moduleField.value.id ? 'module.label.update' : 'module.label.insert') | translate}}</label>
          <span>
          <button ghost size="tiny" nbButton class="objLink float-right" (click)="cancel()">
            <nb-icon icon="close-outline"></nb-icon>
          </button>
        </span>
        </nb-card-header>
        <nb-card-body>
          <div class="row">
            <div class="form-group col-md-4">
              <label class="label">{{ 'module.column.code' | translate }}<span
                class="text-danger ml-2">*</span></label>
              <input id="code" nbInput autofocus fullWidth class="form-control" formControlName="code"
                     status="{{(this.moduleField.get('code').invalid
                 && this.moduleField.get('code')?.touched) ? 'danger' : null }}" trim="blur" ngxUppercase ngxNullValue>
              <ngx-inline-message [message]="'module.column.code'"
                                  [formName]="moduleField.get('code')">
              </ngx-inline-message>
            </div>
            <div class="form-group col-md-4">
              <label class="label">{{ 'module.column.name' | translate }}<span
                class="text-danger ml-2">*</span></label>
              <input id="name" nbInput autofocus fullWidth class="form-control" formControlName="name"
                     status="{{(this.moduleField.get('name').invalid
                 &&this.moduleField.get('name')?.touched) ? 'danger' : null }}" trim="blur" ngxNullValue>
              <ngx-inline-message [message]="'module.column.name'"
                                  [formName]="moduleField.get('name')">
              </ngx-inline-message>
            </div>
            <div class="form-group col-md-4">
              <label class="label">{{ 'module.column.icon' | translate }}</label>
              <input nbInput autofocus fullWidth class="form-control" formControlName="icon"
                     status="{{(this.moduleField.get('icon').invalid
                 &&this.moduleField.get('icon')?.touched) ? 'danger' : null }}" trim="blur" ngxNullValue>
              <ngx-inline-message [message]="'module.column.icon'"
                                  [formName]="moduleField.get('icon')">
              </ngx-inline-message>
            </div>
            <div class="form-group col-md-4" *ngIf="this.moduleField.get('isGroup').value != true">
              <label class="label">{{ 'module.column.path_url' | translate }} <span
                class="text-danger ml-2">*</span></label>
              <input nbInput autofocus fullWidth class="form-control" formControlName="pathUrl"
                     status="{{(this.moduleField.get('pathUrl').invalid
                 &&this.moduleField.get('pathUrl')?.touched) ? 'danger' : null }}" trim="blur" ngxNullValue>
              <ngx-inline-message [message]="'module.column.path_url'"
                                  [formName]="moduleField.get('pathUrl')">
              </ngx-inline-message>
            </div>
            <div class="form-group col-md-4" *ngIf="this.moduleField.get('isGroup').value != true">
              <label class="label">{{ 'module.column.parent_id' | translate }}</label>
              <nb-select fullWidth formControlName="parentId" [placeholder]="'module.label.clean' | translate">
                <nb-option [value]="undefined">{{ 'module.label.clean' | translate }}</nb-option>
                <nb-option *ngFor="let parent of parents"
                           [value]="parent.id">{{ parent.name }}</nb-option>
              </nb-select>
              <ngx-inline-message [message]="'module.column.parent_id'"
                                  [formName]="moduleField.get('parentId')">
              </ngx-inline-message>
            </div>
            <div class="form-group col-md-4" *ngIf="this.moduleField.get('isGroup').value != true">
              <label class="label">{{ 'module.column.action' | translate }}</label>
              <nb-select fullWidth multiple formControlName="action" [placeholder]="'module.label.action_clean' | translate">
                <nb-option *ngFor="let action of actions" [value]="action.id">{{ action.name }}</nb-option>
              </nb-select>
              <ngx-inline-message [message]="'module.column.parent_id'"
                                  [formName]="moduleField.get('parentId')">
              </ngx-inline-message>
            </div>
            <div class="form-group col-md-8">
              <label class="label w-100">{{ 'module.column.description' | translate }}</label>
              <textarea nbInput fullWidth formControlName="description" rows="4" ngxNullValue></textarea>
            </div>

            <div class="form-group col-md-4 row">
              <div class="col-sm-6">
                <label class="label w-100">{{ 'module.column.status' | translate }} <span class="text-danger ml-2">*</span> </label>
                <nb-toggle fullWidth formControlName="status"></nb-toggle>
              </div>
              <div class="col-sm-6">
                <label class="label w-100">{{ 'module.column.is_group' | translate }}</label>
                <nb-toggle fullWidth formControlName="isGroup"></nb-toggle>
              </div>
              <div class="col-sm-12" *ngIf="this.moduleField.get('isGroup').value != true">
                <label class="label w-100">{{ 'module.column.access_user' | translate }}</label>
                <nb-toggle fullWidth formControlName="accessUser"></nb-toggle>
              </div>
            </div>
          </div>

          {{ this.moduleField.errors }}
          <div class="row mt-3">
            <div class="col-12 text-center">
              <button nbButton size="small" type="submit" (click)="save()"
                      [disabled]="moduleField.invalid">{{'common.label.save'|translate}}
                <nb-icon icon="save-outline"></nb-icon>
              </button>
              <button nbButton class="ml-2" size="small" (click)="cancel()">{{'common.label.cancel'|translate}}</button>
            </div>
          </div>
        </nb-card-body>
      </nb-card>
    </form>
  </div>
</div>
